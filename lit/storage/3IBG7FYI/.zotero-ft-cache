Advances in Functional and Structural MR Image Analysis and Implementation as FSL
Technical Report TR04SS2
Stephen M. Smith, Mark Jenkinson, Mark W. Woolrich, Christian F. Beckmann, Timothy E.J. Behrens, Heidi Johansen-Berg, Peter R. Bannister, Marilena De Luca, Ivana Drobnjak, David E. Flitney, Rami K. Niazy, James Saunders, John Vickers,
¡
Yongyue Zhang, Nicola De Stefano , J. Michael Brady , Paul M. Matthews
FMRIB (Oxford Centre for Functional Magnetic Resonance Imaging of the Brain) Department of Clinical Neurology, Oxford University, John Radcliffe Hospital, Headington, Oxford OX3 9DU, UK
2: Dept. Neurological & Behavioral Sciences, University of Siena, Italy 3: Dept. Engineering, Oxford University, UK
steve@fmrib.ox.ac.uk www.fmrib.ox.ac.uk/analysis
Abstract
The techniques available for the interrogation and analysis of neuroimaging data have a large inﬂuence in determining the ﬂexibility, sensitivity and scope of neuroimaging experiments. The development of such methodologies has allowed investigators to address scientiﬁc questions which could not previously be answered and, as such, has become an important research area in its own right.
In this paper, we present a review of the research carried out by the Analysis Group at the Oxford Centre for Functional MRI of the Brain (FMRIB). This research has focussed on the development of new methodologies for the analysis of both structural and functional magnetic resonance imaging data . The majority of the research laid out in this paper has been implemented as freely available software tools within FMRIB’s Software Library (FSL).
1 Introduction
In recent years, Magnetic Resonance Imaging and functional MRI have played an increasingly important role in the investigation of brain structure, function, development and pathologies. The increasing ﬂexibility and power of MRI and FMRI to answer scientiﬁcally interesting and clinically relevant questions has led to a demand for analysis techniques which allow investigators to interrogate their data in as ﬂexible, scientiﬁcally informative and convenient a manner as is possible. This paper presents an overview of research carried out with this aim, in the Analysis Group at the Oxford Centre for Functional MRI of the Brain (FMRIB).
The broadest distinction which can be drawn between MRI experiments in the brain is between structural experiments, which are sensitive to biophysical properties of local brain tissue, and functional experiments, which are sensitive to temporally changing neural activity. The two types of MRI data require very different analysis techniques and are grouped into separate sections in this paper, but the relationship between structure and function is fundamental to brain organisation. The data analysis techniques and tools described in sections 2 (functional analysis) and 3 (structural analysis) allow investigators not only to learn from each source of information, but also to combine data from functional and structural experiments to better inform neuropsychological inference. Section 4 is an example of this interdependence between structure and function, investigating the inﬂuence of structural connectivity on brain function. Fundamental to the ability to draw inference from data is a thorough understanding of the processes involved in the data’s creation. The research outlined in section 5 gives examples of how to improve this understanding via direct modelling of the MR image acquisition process. Crucially, this allows investigators to increase the sensitivity of their MRI experiments through both improved experimental design and the reduction of acquisition-related image artefacts. Finally, section 6 describes brieﬂy the freely available FSL software package, within which most of the research covered in this paper has been implemented.
1

Relative Parameter Estimation Efficiency

1 Prewhitening
0.8

0.6 Precolouring
0.4

0.2

0 Boxcar

SE(Fixed ISI) SE(Jittered ISI) SE(Randomised ISI)

Figure 1: Relative efﬁciency when using prewhitening or colouring for dealing with temporal autocorrelation, for four different types of regressor (SE = single-event, ISI = inter-stimulus interval)

2 Functional MRI Analysis Research
The fundamental challenge in the analysis of functional MRI experiments is to identify voxels that show signal changes varying with changing brain states. This is a difﬁcult problem: ﬁrstly because the signal to noise ratio is generally poor, with the activation signal being often no larger than the noise level; secondly, the neurophysiology which couples the underlying brain activity to the measured response in FMRI is complex and generally poorly understood; and thirdly, the noise consists of a complex blend of spatio-temporal deterministic and stochastic components due to physiological and scanner-based artefacts.
Advances in data modelling have the potential to greatly increase our ability to detect neural activations and investigate brain function using FMRI. This section reviews research carried out by FMRIB to tackle these issues. This includes our research within the modelbased voxelwise general linear model (GLM) for modelling single-session data (FILM), and the Bayesian method for analysing multiple sessions/subjects (FLAME). FEAT is a complete GUI-based tool for model-based FMRI analysis, built around FILM and FLAME, as well as other low-level tools such as FLIRT image registration.
Complementary to the model-based analyses, MELODIC uses independent component analysis to carry out “temporal model-free” exploratory analysis. This approach is able to identify signal and structured noise in FMRI data without needing to be given a temporal model.
We complete this section with recent development in the area of inference (“thresholding”), using spatial mixture modelling to address some of the limitations associated with the current common practice of linear data smoothing and null hypothesis testing.
2.1 FILM - Voxelwise Timeseries Analysis
In FMRI statistical analysis there are problems with accounting for temporal autocorrelation (the intrinsic smoothness in each voxel’s timeseries). Unless this is correctly accounted for, the timeseries analysis is at best inefﬁcient (in terms of sensitivity to true activation) and at worst statistically invalid. Commonly, techniques have utilised temporal ﬁltering strategies to either shape these autocorrelations, or remove them. Shaping, or “colouring”, attempts to negate the effects of not accurately knowing the intrinsic autocorrelations by imposing known autocorrelation via further smoothing. Removing the autocorrelation, or “prewhitening”, gives the best linear unbiased estimator, if the autocorrelation can be accurately estimated.
In [43] we demonstrated that when using block designs, colouring can be used with minimal loss of efﬁciency. However, as shown in ﬁgure 1, for single-event designs with randomized intervals, jittering or just very short intervals, colouring is much less efﬁcient and hence prewhitening is desirable. It had previously been suggested that sufﬁciently accurate estimates of the autocorrelation are currently not available to give prewhitening acceptable accuracy [18]. To overcome this, we developed the following methodology for accurate voxelwise autocorrelation estimation. Firstly, high-pass ﬁltering needs to be performed as a preprocessing step to remove the worst of the large-scale, non-stationary components and low frequency noise. Secondly, we investigated various methods of initial estimation (and regularisation) of the autocorrelation coefﬁcients, ﬁnding that applying a Tukey taper to the raw estimates (to smoothly “roll off” higher lags) gave the best results. Thirdly, spatial smoothing of the resulting autocorrelation estimates was found to be important in reducing bias further. The autocorrelation was found to vary considerably between matter types (with higher autocorrelation in the grey matter than in white). Therefore, we apply non-linear spatial smoothing [32] to the autocorrelation coefﬁcients, only smoothing within matter type.
Using the above approach we were able to demonstrate close to zero bias at probability levels as low as ¢¡ £¤£¦¥ [43]. We thus
obtain optimally efﬁcient estimation of the model parameters, giving greater sensitivity to activation than if colouring were used. Furthermore, even with this more ﬂexible model, we are able to ﬁnd the autocorrelation function at a voxel level, i.e., do not need to rely, in order to obtain robustness, on relatively inaccurate global estimation. This approach has been implemented as FILM
2

(FMRIB’s Improved Linear Model), the time-series modelling tool used within FEAT.
2.2 FLAME - Multi-Level Modelling for Group Analysis
FMRI studies are typically used to address questions about activation effects in populations of subjects. This involves a multi-subject and/or multi-session approach where data are analysed in such a way as to allow for hypothesis tests at the group level [19]. In order to be able to generate results that accurately extend to the wider population, we need to account for the fact that these limited samples from the population are random quantities with associated random effects variances. We can formulate the problem of group statistics hierarchically [3]; the different levels of the hierachy could be separate GLMs at within-session level, within-subject-cross-session level and cross-subject level.
In [17] the hierarchical model is approached using all time-series data as input to a single “all-in-one” analysis. However, in neuroimaging, where the human and computational costs involved in data analysis are relatively high, it is desirable to be able to make top-level inferences using the results of separate lower-level analyses without the need to re-analyse the lower-level data, an approach commonly referred to as the summary statistics approach to FMRI analysis [19]. In [3] we showed that top-level inference using the “split-level summary statistics” approach can be made exactly equivalent to an all-in-one approach if we feed up the correct summary statistics (in particular, the covariances from lower levels). It was demonstrated that by taking into account lower-level covariances and heterogeneity, a substantial increase in higher-level z-statistic is possible. Another reason for wanting to carry up lower-level covariances to higher-level analyses is that it is not then necessary for lower-level design matrices to be identical (i.e., “balanced designs” - for example having the same number of time points or event timings).
The investigations covered in [3] assume that all variance components are known; taking this work further, in [39], using a fully Bayesian approach, we show the split-level model equivalence taking into account that the variance components are unknown.
There are three main contributions presented in [39]. Firstly, “reference priors” were introduced to neuro-imaging; due to the typically small numbers of sessions or subjects in neuro-imaging the choice of prior is critical. Secondly, two practical inference techniques were developed for multi-level hierarchies: a fast approach using maximum a posterior estimates and a slower, more accurate approach using Markov Chain Monte Carlo (MCMC). Thirdly, it was shown that we can infer on the top-level of multilevel hierarchies by inferring on the split levels separately and passing summary statistics (multivariate non-central t-distributions) between them. The use of the lower-level covariance information contained in these summary statistics overcomes the “negative variance” problem experienced using previous approaches to split-level analyses [19].
This research has been implemented as FLAME (FMRIB’s Local Analysis of Mixed Effects), the higher-level modelling tool used inside FEAT. One additional advantage of using FLAME is that it is easy to model and estimate different variances for different groups of subjects in the model. For example, an unpaired two-group comparison (e.g. between controls and patients) can be analysed with separate estimates of variance for each group.
2.3 FEAT - A Complete Tool for Model-Based FMRI Analysis
FEAT is an advanced GLM-based FMRI analysis tool with a straightforward but powerful GUI (graphical user interface), carrying out data preprocessing (including slice timing correction and MCFLIRT motion correction - see below); ﬁrst-level GLM timeseries analysis with prewhitening (FILM); registration to subject-speciﬁc structural images and standard space (FLIRT); and fully generalised mixed-effects group analysis using Bayesian estimation techniques (FLAME).
FEAT has been developed with two goals in mind; to use the most sophisticated image processing/statistical methodologies available (FILM, FLAME, FLIRT etc.), whilst at the same time making the user interface as intuitive and simple as possible, though allowing fully general/ﬂexible analysis design. Complete analysis for a single simple FMRI experiment can often be set up in less than 1 minute, whilst a highly complex experiment typically need take no longer than 5 minutes to set up. The FEAT programs then typically take 10-30 minutes to run (per ﬁrst-level session), producing a web page analysis report (including activation overlay images, activation cluster tables, time-course plots of data vs model, registration overlay images and an “Analysis Methods” paragraph describing the exact analysis carried out, including references). Multiple experiments having the same design can be analysed with a single setup. A complete setup can be saved to ﬁle, for easy reloading, amendment and re-running later, or to be used in script-based analysis of multiple experiments.
In [31] 33 supposedly identical FMRI sessions from the same subject were analysed, partly to investigate the nature of session variability (as a follow-up to the original investigation using this data [28]), and partly to compare the different preprocessing, registration and time series statistical options in FEAT and SPM. The general conclusion (regarding the latter issue) was that both with respect to preprocessing/registration and time series modelling, less “extra” apparent session variability was induced by the FEAT processing modules, suggesting higher accuracy. Similar results were reported in [9].
3

Figure 2: Example FEAT GUI snapshots. Top left: main GUI, with preprocessing section exposed. Bottom left: simple model wizard for regular block or single-event designs. Centre: model setup GUI for more complex designs enabling the selection of any number of covariates, various stimulus timing options, a variety of HRF convolution options (including basis functions), covariate orthogonalisation and any number of contrasts and f-tests. Right: design matrix and contrasts display showing covariates as the main columns with contrasts below.
(a) Unconstrained (b) Constrained
Figure 3: Samples from the HRF basis set: (a) unconstrained (b) constrained. Below is the difference in voxel classiﬁcation between the constrained HRF model and the unconstrained HRF model for a single-event pain stimulus dataset. [red] voxels are active for both models, [yellow] voxels are active for just the constrained HRF model, and [blue] voxels are active for just the unconstrained HRF model.
2.4 Bayesian Inference on Constrained Linear Basis Sets for HRF Models
FMRI analysis ideally requires ﬂexible haemodynamic response function (HRF) modelling, with the HRF being allowed to vary spatially and between subjects. To achieve this ﬂexibility, in [42] we proposed voxel-wise HRF modelling using a parameterised HRF consisting of a number of joined half-cosines. This was embedded in a fully Bayesian framework, incorporating non-separable spatio-temporal noise modelling. A fully Bayesian approach allows for the uncertainties in the noise and signal modelling to be incorporated together to provide full posterior distributions of the HRF parameters. However, inference on such parameterised HRF models is slow. A more practical approach to voxel-wise HRF modelling is to use basis functions. This allows us to proceed in the more manageable GLM framework. The problem with this is that, as shown in ﬁg. 3a, a large amount of the subspace spanned by the basis functions produces nonsensical HRF shapes. Therefore, in [41] we proposed a technique for choosing a basis set, and then, importantly, the means to constrain the subspace spanned by the basis set to only include sensible HRF shapes. The choice of the basis set can be driven by a standard parametric HRF, or a physiologically informed model such as the balloon model [11]. Using the GLM in a Bayesian framework we can then use priors on the basis function regression parameters to constrain the linear combinations of HRFs to sensible HRF shapes, as shown in ﬁg. 3b. This was augmented with spatially regularised autoregressive noise modelling. Inference was carried out using Variational Bayes (an efﬁcient alternative to MCMC for posterior distribution estimation, making simplifying assumptions about the form of the posterior). As shown in ﬁg. 3, constraining the subspace spanned by the basis set allows for superior separation of activating voxels from non-activating voxels in FMRI data. This approach will be included in future versions of FEAT.
2.5 MELODIC - Probabilistic Independent Component Analysis for FMRI
Independent Component Analysis (ICA) is becoming a popular exploratory method for analysing complex data such as that from FMRI experiments. ICA attempts to decompose the data into (statistically) independent spatial maps (and associated time courses),
4

Figure 4: GLM, classical ICA and PICA analyses of visual stimulus FMRI data: (a) GLM results using GRF-based inference.
(b-e) IC maps from classical ICA having temporal correlation ¡ with GLM model; the secondary maps are uninterpretable. (f) ¡
eigenspectrum of the data covariance matrix and PICA estimate of the latent dimensionality. (g,h) PICA maps; the secondary map is postulated as V3/MT and is reliably found by PICA in such data.
Figure 5: Additional PICA maps from the visual activation data: (a) head motion (translation in Z), (b) sensory motor activation, (c) signal ﬂuctuations in areas close to the sinuses (possibly due to interaction of ﬁeld inhomogeneity with head motion), (d) high frequency MR ’ghost’ and (e) ’resting- state’ ﬂuctuations/ physiological noise.
which ideally each represent different artefacts or activation patterns. By using all of the 4D dataset together in the analysis, this kind of approach does not need a (temporal) model, in the way that the above research does. The application of such “model-free” methods, however, has been restricted both by the view that results can be uninterpretable and by the lack of ability to quantify statistical signiﬁcance for estimated spatial maps. In [4] we proposed a probabilistic ICA (PICA) model for FMRI which models the observations as mixtures of spatially non-Gaussian signals and artefacts in the presence of Gaussian noise. We demonstrated that using an objective estimation of the amount of Gaussian noise through Bayesian analysis of the number of activation and (non-Gaussian) noise sources, the problem of “overﬁtting” can be overcome. The approach proposed for estimating a suitable model order (i.e., how many ICA components to ﬁnd) also allows for a unique decomposition of the data and reduces problems of interpretation, as each ﬁnal component is more likely to be due to only one physical or physiological process (ﬁgs. 4,5). The model also advanced standard ICA with other improvements, such as voxel-wise temporal pre-whitening, variance normalisation of timeseries and the use of prior information about the spatio-temporal nature of the source processes. Finally, in order to statistically infer areas of activation from the estimated PICA maps, we used an alternative-hypothesis testing approach based on a non-spatial Gaussian/Gamma mixture model [6]. The above methodology is implemented as MELODIC (Multivariate Exploratory Linear Optimised Decomposition into Independent Components). As an application of this exploratory approach, we have applied PICA to ﬁnd resting state networks (RSNs) without the need for
“seeding”. RSNs are low frequency ( ¡ ¥ Hz) spatially-distributed networks with self-consistent time-course that have previously ¢
been identiﬁed in resting FMRI data using correlation with a seed pixel’s timecourse [10]. Their underlying cause is not yet proven,
5

a

b

Figure 6: RSNs found in 2x1.5x1.75mm resting FMRI data (a) and 4 RSN spatial maps identiﬁed as consistent across 7 subjects (b).
though it has been postulated that they reﬂect functional networks (as opposed to being physiologically based but functionally uninteresting). We have attempted to further characterise these networks using resting FMRI, both because of their potentially interesting nature, and because they represent a major cause of (currently unmodelled) structured “noise” in FMRI data.
The PICA approach appears to successfully separate different RSNs from each other and from other (physiological and scanner-
related) components in resting (and even activation) FMRI data. Using low-TR data ( ¢¡ ¥ s) to avoid aliasing of cardiac-related and ¢
breathing-related components (and therefore to be able to unambiguously separate these components in the data), we have shown that RSNs are indeed not directly related to these components [14]. Using high resolution (2x1.5x1.75mm) data we have separated “true” RSNs (ﬁg. 6(a)), which do indeed appear to lie purely within grey matter, from other networks having similar power spectra
( ¡ ¥ Hz) which appear to lie in larger blood vessels [14]. ¢
We have further investigated whether the number and spatial localisation of RSNs is consistent across different subjects. We have identiﬁed 4 RSNs which appear to have high repeatability when analysed across 7 subjects (posited as V1, spatial association and V2, motor area and attention area, see ﬁg. 6(b)) [13].
The PICA methodology is further extended in [5] to the analysis of multi-session/multi-subject FMRI data via a novel exploratory probabilistic tensor-ICA model which provides a tri-linear decomposition and estimates the signal characteristics in the temporal, spatial and subject/session domain. The resulting data representation provides a rich source of information with which to infer not only on the spatial characteristics of activation but also to enable learning about the variability across the sessions/subjects.
2.6 Inference via Spatial Mixture Modelling
Commonly in FMRI, null hypothesis testing is used on a GLM to label voxels, or clusters of voxels, as being “active” if they reject the null hypothesis at a given false positive rate (FPR). This depends on knowing the null distribution for the relevant statistic (e.g., regression parameter, t-statistic or pseudo-t) under the null hypothesis. An alternative approach for inference is to use mixture modelling on the statistic of interest [16]. This involves ﬁtting a mixture of distributions to the histogram of the statistic of interest; in our case we use a Gaussian for the central non-activation part of the data, and a gamma for the activation (and possibly another for “deactivation”).
A well-known problem in null hypothesis testing of FMRI is that if enough observations are made, then every voxel in the brain will reject the null hypothesis. This is because in practice all voxels will show some response to the stimulus, if only due to modelling inadequacies such as unmodelled stimulus-correlated motion or the point spread function of the scanner. By using mixture modelling, instead of asking the question “Is the activation zero or not?”, we ask the question “Is the activation bigger than the overall background ‘signal’?”. Adaptability in modelling the non-activating (“null”) part of the distribution can also help to protect against violations of the modelling assumptions, such as poorly modelled noise structure. Mixture modelling also provides us with far more inference ﬂexibility compared with null hypothesis testing. We can either control FPRs or TPRs (true positive rates) by using the “non-activating” or “activating” distributions respectively. Controlling the TPR may be of real importance when using FMRI for pre-surgery planning. Non-spatial mixture modelling is already used in FSL for statistically inferring areas of “activation” in MELODIC (see section 2.5).
In null hypothesis testing one can incorporate spatial information by using smoothing in combination with Gaussian Random Field Theory [44]. However, this requires the arbitrary setting of parameters (the t/z threshold for forming clusters, and the amount of spatial smoothing) and makes the resulting inference hard to interpret. In contradistinction, we can incorporate spatial information into mixture modelling by encoding the prior belief that we expect to ﬁnd areas of activation next to other areas of activation. In [40] we describe a novel way to do this with the amount of spatial regularisation determined adaptively from the data using a discrete-labels Markov Random Field (MRF) prior on the classiﬁcation. Heuristic tuning of control parameters is no longer required. All parameters in the model are adaptively determined from the data, and hence we can infer regions of brain activity completely objectively. Figure 7 shows the spatial mixture model applied to a single-event pain stimulus experiment.
6

Figure 7: Results of applying the spatial mixture modelling on a single-event pain stimulus experiment. [top left] z-statistic parametric maps. [bottom left] Probability of being in the activation class. [right] Mixture model ﬁt to histogram of pseudo-z-statistics.
Figure 8: Example BET and FAST output. Middle: extracted brain and external skull surface points from BET. Right: CSF, white and grey partial volume colour overlays from FAST.
3 Structural MRI Analysis Research
This section presents an overview of our research into the analysis of structural MRI data. The tools resulting from this research provide the means for making quantitative measurements of physiologically or clinically relevant parameters. For example, the combination in SIENA of brain extraction (BET), tissue-type segmentation (FAST) and robust afﬁne registration (FLIRT) allows for the accurate measurement of temporal brain-volume change. However, these tools are also of crucial importance in the processing stream in functional neuroimaging experiments. BET and FLIRT not only allow functional results to be interpreted in the context of the anatomy visible in structural images, but also allow data from different individuals and groups of individuals to be compared directly.
3.1 BET - Brain/Non-Brain Segmentation
There are many applications related to brain imaging which either require, or beneﬁt from, the ability to accurately segment brain from non-brain tissue. For example, in the registration of functional images to high resolution MR images, both FMRI and PET functional images often contain little non-brain tissue because of the nature of the imaging, whereas the high resolution MR image probably will contain a considerable amount - eyes, skin, fat, muscle, etc - and thus registration robustness is improved if these non-brain parts of the image can be automatically removed before registration. Also, many tissue-type segmentation approaches (such as FAST, see below) require brain/non-brain segmentation to have been carried out before being they can function well. We have developed a tool for fully automated brain extraction which runs robustly on a variety of MR modalities (tested on T1weighted, T2-weighted, proton density, EPI, etc.), called BET (Brain Extraction Tool) [30]. At the core of the algorithm a triangular tesselation of a spherical surface is initialised inside the brain, and allowed to slowly deform, one vertex at a time, following forces that keep the surface well-spaced and smooth, whilst attempting to move towards the brain’s edge (deﬁned in terms of the local intensity structure, to reduce the effects of image bias ﬁeld). If a suitably clean solution is not arrived at then the whole process is re-run with a higher smoothness constraint. Finally, if required, the outer surface of the skull can be estimated. See ﬁg. 8 for example BET output.
7

3.2 FAST - Tissue-Type Segmentation and Bias Field Correction
Following brain/non-brain segmentation, tissue-type segmentation can be performed, that is, classiﬁcation of each voxel into grey, white, or CSF (cerebro-spinal ﬂuid) and possibly pathology (e.g., lesion). It is common to segment purely on the basis of voxel intensity, once intensity thresholds have been found to optimally distinguish between the different tissue classes. This can be considered as an analysis of the image histogram, where the different classes appear (ideally) as separate peaks, which have a spread caused by factors such as image noise, motion artefacts, partial-volume effect, bias ﬁeld (intensity ﬂuctuations across the image caused by inhomogeneities in the radio-frequency ﬁeld) and true within-class variation. This spread can cause serious mislabelling of voxels, particularly if the bias ﬁeld is strong.
A central problem is that robust and accurate estimation of the bias ﬁeld ideally requires perfect knowledge of the segmentation, whilst obtaining a perfect segmentation requires that the bias ﬁeld be known and corrected. This circularity of dependence means that a sensible approach to both problems is to solve the two problems together, in practise iterating between estimating the segmentation and the bias ﬁeld, until convergence. This is the approach taken in FAST (FMRIB’s Automated Segmentation Tool) [45]. The histogram is modelled as a mixture of Gaussians (one for each class), giving each class’s mean (and variance) intensity. Each voxel is then labelled by taking into account not just its intensity with respect to the estimated class means, but also the labelling of its local neighbours - a Markov random ﬁeld (MRF) is placed on the labelling, causing spatial regularisation (i.e., smoothness of segmentation). This greatly reduces the effect of noise on the segmentation. The segmentation allows an idealised reconstruction of the image; subtracting this from the real image (and smoothing) gives an estimate of the bias ﬁeld. This whole process is then iterated several times.
If required, FAST also models the partial volume effect (PVE) at each voxel. The voxel’s intensity with respect to the global class mean and variance intensities is used to estimate the PVE, and this is augmented with an MRF on the PVE to spatially regularise with local voxels.
The above approach easily generalises to “multi-channel segmentation”, i.e. if more than one input modality (image type) is available. For example, if both T1-weighted and proton density images are available, the input can be thought of as a vector image instead of just a scalar. FAST allows for two or more input images, which can give improved results, for example, in the deep grey structures where T1-only segmentation often has problems due to the intermediate (between white and cortical grey) intensities of some subcortical “grey” mattter.
FAST does not use segmentation priors (images in standard space of the expected distribution of the tissue types, averaged over many subjects) by default, as the prior segmentation images tend to be very blurred, and therefore not very informative. However, this option can be turned on, for example, to aid the initial segmentation in the case of very bad bias ﬁeld.
3.3 FLIRT - Afﬁne Inter-Modal Image Registration
Robust automated intensity-based image registration is a core capability needed for most brain image analysis applications. Ideally it provides a fast, accurate, robust and objective way to align images of the same or different MR modalities, crucial for many applications such as localising functional activations within a subject’s own neuro-anatomy and for allowing group comparisons via the registration to a standard image. However, a common problem is that registration methods sometimes fail to produce “sensible” results, with gross misalignment clearly visible. These failures often occur when the images being registered are initially in different orientations. For automated analysis methods that rely on registration (e.g., FMRI analysis and atrophy analysis), such failures are very problematic.
The standard framework for intensity-based registration involves the minimisation of a cost function (which quantitates how well aligned two images are) as the registration parameters (such as rotation and translation) are varied. Consequently, the cause of misregistrations arises from either non-ideal cost functions (which return minimum values for poor alignments) or from non-ideal optimisation methods which fail to ﬁnd the (global) minimum value of the cost function. Much work has gone into proposing suitable cost functions for image registration, for example, using information theory [38]. However, little work has been done on improving optimisation methods for image registration, even though “getting stuck” in a local minimum is the main cause of failure for registration methods.
The research conducted at FMRIB in afﬁne registration [23, 22] has concentrated on trying to eliminate the occurrence of gross misalignments (increasing robustness) by using a multi-start, multi-resolution global optimisation method. This optimisation starts with a large-scale search strategy (e.g., trying “all” possible initial rotations) at an 8mm image resolution, followed by a series of multi-start local optimisations at a 4mm resolution (based on perturbations of the best candidate alignments found at the 8mm stage), and ﬁnishes with a progressive sequence of local optimisations at 2mm and 1mm resolutions to reﬁne the ﬁnal alignment. This strategy is considerably more robust than optimisation based purely on local minimisation (even if a multi-resolution approach is used). A major advantage of this optimisation method versus generic global optimisation methods is that it is speciﬁcally designed
8

for afﬁne image registration, incorporating knowledge of the expected and achievable parameter changes. As a consequence it is more efﬁcient in searching the parameter space, allowing it to run signiﬁcantly faster than would be possible using other techniques such as Simulated Annealing or Genetic Algorithms.
In addition to the work on the global optimisation method, modiﬁcations of the standard cost functions to down-weight voxels at the edge of the common overlapping ﬁeld-of-view and use fuzzy-binning techniques for histogram estimation have been applied to reduce the number of local cost function minima present. As well as standard within-modality cost functions such as normalised correlation, we have implemented inter-modal cost functions such as mutual information [38] and correlation ratio [29], which allow the robust registration of images with different contrasts such as FMRI to structural MRI, or PET to MRI. The combination of the optimisation technique and cost function modiﬁcations has led to the development of FLIRT (FMRIB’s Linear Image Registration Tool) which has been proven to be highly robust [23, 22] and is incorporated in many fully automated image analysis methods (e.g., SIENA and FEAT).
3.4 MCFLIRT & FORCE - Head Motion Correction
Motion correction is an important issue in FMRI analysis as even the slightest patient motion can induce signiﬁcant motion artefacts (potentially of greater magnitude than the BOLD effect itself), particularly at tissue boundaries, at the edge of the brain or near major vessels.
A rigid-body motion correction tool was developed based on the afﬁne registration tool in FSL (FLIRT, see below). This method (MCFLIRT) applies the same cost function regularisation techniques as FLIRT but does not need the multi-start optimisation techniques since movement from one volume to another within an FMRI sequence is small, giving good initialisation. Instead, the tool was speciﬁcally customised to be highly accurate for typical FMRI data [22].
Motion correction, however, is an inherently non-rigid problem since the volume is not acquired at a single instant, but each slice is acquired at a different time. Consequently, when the head is moving, each slice is transformed by a slightly different rigid-body transformation, making whole-volume-rigid-body-correction oversimplistic. Furthermore, the fact that each slice has slightly shifted timing with respect to each other is incompatible with the assumptions of subsequent temporal analysis. This is often dealt with by applying a slice-timing correction (interpolation within each voxel’s time series) either before or after rigid-body motion correction. Applying rigid-body motion correction and slice-timing corrections separately (in either order) is imperfect, as the two problems arise simultaneously and therefore need to be solved in a single integrated approach.
To this end we have developed a limited degree of freedom (DOF) model of the slice transformation process, assuming smooth motion within each TR. (This model is an approximation to the real situation where any sudden small motion could occur during a TR; using a more general model is problematic as it introduces extra degrees of freedom, requiring rigid-body registration of a single slice to a reference volume, which is non-robust and inaccurate.) Cost functions are generalised from the 3D case to include the entire 4D data set since it is unlikely that any single volume can be relied upon to provide a sufﬁciently accurate (motion-free) reference volume. Initial results using this approach (referred to as FORCE - FMRIB’s Optimized Retrospective Correction Environment) indicate that it is possible to reduce ﬁnal motion-related error in comparison with separated rigid-body correction and slice-timing correction [2].
3.5 SIENA - Brain Change Analysis
Quantitative measurement of change in brain size and shape (for example, in order to estimate atrophy) is an important tool for analysis of clinical imaging data. SIENA [34, 35] (Structural Image Evaluation, using Normalisation, of Atrophy) is a fully automated method for ﬁnding temporal brain change, taking as input two MR images taken at different points in time, and giving as output a “change” image, along with a global estimate of percentage brain volume change. SIENA uses BET to segment brain from non-brain in each image, and also estimate the external surface of the skull in each. Next, the two brain images are registered with FLIRT, using the skull images to constrain scaling and skew; this corrects for changes in imaging geometry over time. Brain surface points (including at the ventricle edges) are then found with FAST, and the surface motion (between the two time points) estimated at these points, to subvoxel accuracy. The mean perpendicular edge motion across the entire brain surface can then be converted into a percentage brain volume change estimate. In a range of validations, SIENA has been shown to be accurate to better than 0.2% brain volume change.
SIENA has also been extended to a single-time-point method (SIENAX [35]) which estimates atrophy state rather than atrophy rate. SIENAX uses brain extraction and tissue-type segmentation to ﬁnd brain volume and then brain-and-skull-based registration (similar to that used by SIENA) to normalise (for head size) to standard space (using the skull image for the scaling), to reduce inter-subject variability. SIENAX has been shown to be accurate to better than 1% error in normalised brain volume.
9

Figure 9: Example SIENA/SIENAX outputs. Left: SIENA edge motion estimation (blue=atrophy, red=”growth”). Top middle: voxelwise SIENA analysis, showing signiﬁcant atrophy voxels in a group of MS patients. Top right: brain mask as generated by SIENAX, with upper and lower ﬁeld-of-view limits automatically imposed in an objective way via standard-space registration (needed to make all subjects’ data comparable if some subjects in a study were not scanned with complete ﬁeld-of-view). Bottom right: SIENAX estimation of cortical grey volume (standard-space masks automatically used to exclude non-cortical grey matter).
More recently [15], SIENA has been extended to allow voxelwise statistical analysis of brain change across multiple subjects. This allows, for example, local estimation of group-wise atrophy, or even local estimation or where atrophy correlates with other variables such as age, drug treatment or disease duration.
A similar method has been proposed for voxelwise statistical analysis of magnetisation transfer ratio (MTr) images [33]. Because MTr is dependent on tissue type (as well as factos of interest, such as pathology), it is not possible to simply transform MTr images into standard space to carry out voxelwise statistics across subjects. Instead, the raw MTr image is split into (sparse) grey and white MTr images (using the output from FAST), which are dilated to “ﬁll in the gaps”. These are then transformed into standard space before being masked by standard grey and white matter masks and recombined. Thus for any given standard space grey (or white) voxel, the MTr value at this point is taken from the subject’s MTr value at the nearest true grey (or white) voxel. Voxelwise cross-subject statistics are then possible.
4 FDT - Diffusion and White Matter Connectivity Analysis
The self-diffusion of water molecules in the brain is a sensitive probe of biological tissue microstructure and micro-biophysics. Amongst the tissue properties which contribute to the local diffusion characteristics is the local orientational structure of the tissue; most interestingly, diffusion is anisotropic in white matter, being greater in the direction of white matter tracts. By sensitising the magnitude of the NMR spin-echo to local diffusion and by making assumptions about the structure of local diffusion it is possible to recover the dominant orientation of diffusion in each MR imaging voxel [12], known as the principal diffusion direction (PDD). Under the assumption that these PDDs correspond well with the mean local ﬁbre orientation in white matter voxels, it has been possible to trace pathways through the vector ﬁeld of PDDs to reconstruct major white matter pathways in the living human brain [37]. However, the sensitivity of this “diffusion tractography” process to, for example, image noise, partial volume effects and incomplete signal modelling has meant that, in general, tractography has been limited to major white matter pathways which are easily found in post-mortem dissection. Furthermore, the deterministic nature of tractography approaches to date have meant that the descriptions of the estimated ﬁbre trajectories have been entirely qualitative. With no measure of either conﬁdence in or strength of the recovered connections, the interpretation of the trajectories as true ﬁbre pathways has been limited and it has not been possible to compare results between subjects in a quantitative fashion.
Research at FMRIB has concentrated on developing a statistical framework in which to address the tractography problem. By considering the ﬁtting of voxel-wise models of diffusion in the presence of image noise and incomplete signal modelling we are able to construct probability density functions (pdf s) on the voxelwise PDD (local mean ﬁbre orientation) [7]. With these local pdf s on ﬁbre direction it is no longer sensible to perform tractography by tracing deterministic pathways through the data ﬁeld. Instead, we have developed a generalisation of diffusion tractography to the case where there is uncertainty in local ﬁbre orientation [7]. We estimate a pdf on the location of the ﬁbre trajectory (a connectivity distribution). We are able to quantify our belief in the location of the pathway and hence quantify our belief in the existence of axonal connections between brain regions. By removing the need to make a deterministic decision at every step in the tractography process, we are able to trace beyond regions of low diffusion
10

Figure 10: (a) Connectivity distribution from medio-dorsal thalamus. Consistent with macaque data, the distribution terminates in prefrontal cortex and anterior temporal cortex. (b) Major connection zones of the thalamic nuclei ascertained from the macaque literature; the cortical zones used for the connectivity-based segmentation of thalamus. (c) Inset: prediction from macaque data of the major connections of the thalamic nuclei. Main: connectivity-based segmentation of human thalamus. (d) Functional validation. The outer grey surface deﬁnes thalamus. The inner grey surface deﬁnes the region in which at least 4 out of 11 subjects had a greater than 25% chance of connection to prefrontal cortex. Red spheres are the centres of thalamic activation in 27 executive memory tasks which also activated prefrontal cortex.
anisotropy and deep into grey matter structures (see ﬁg. 10a) [8]. This methodology has been implemented as FDT (FMRIB’s Diffusion Toolbox).
The availability of such a rich source of connectivity information has allowed us to address new questions with diffusion tractography. It is possible, by examining connectivity patterns derived from diffusion tractography, to identify functionally distinct subunits in the brain. For example, by generating connectivity distributions from every voxel in thalamus we have been able to compute the probability of connection from every thalamic voxel to each of seven predeﬁned cortical zones. We have used this information to segment thalamus into putative thalamic nuclei on the basis of connectivity information alone [8] (ﬁg. 10b,c). These connectivitydeﬁned regions form the basis of an atlas of thalamo-cortical connectivity (www.fmrib.ox.ac.uk/connect) which we have used to provide the ﬁrst functional/anatomical validation of diffusion tractography [26]. For example, in ﬁg. 10d, the thalamic region deﬁned by a high probability of connection with prefrontal cortex corresponds well with the location of previously reported (FMRI/PET) activation centres in executive memory tasks.
5 MR Physics-Related Research
5.1 PRELUDE & FUGUE - EPI Distortion Correction
Distortion of EPI-based functional images is a particular problem for high ﬁeld (3T and higher) MR scanners. The inhomogeneities in the magnetic ﬁeld caused by susceptibility differences at air-tissue interfaces (predominantly air-ﬁlled sinuses) result in both signal loss and geometric distortion of images. Such artefacts are particularly noticeable in the inferior temporal and frontal lobes and restrict the use of standard FMRI or diffusion imaging techniques in these areas. In addition, the distortions can also lead to global errors in registration, if not accounted for, causing errors in the spatial localisation of activations (or white matter tracts) from any brain region, including those where there is little or no distortion present.
One approach to solving this problem is to use a measured ﬁeld-map to “unwarp” the distorted images by performing pixel shifts in the phase-encode direction [25] (see ﬁg. 11); although this cannot restore lost signal (intensity), it can correct for local geometric distortion. Such methods require the acquisition of a B0 ﬁeld map which we obtain from a phase-difference image. This ﬁrst requires “phase unwrapping” to compensate for the fact that MR phase measurements are wrapped within the range 0:2 . A general Ndimensional phase-unwrapping technique [21] was developed for this task, based on optimising a global cost function that penalises large, spatially-localised phase changes. To improve speed and robustness, an efﬁcient implementation (PRELUDE - Phase Region Expanding Labeller for Unwrapping Discrete Estimates) using region-based labelling and merging techniques was created. This technique has proved to be robust and reliable over a wide range of MR phase images, including high-resolution venogram studies.
Following phase unwrapping, the ﬁeld map values are used to determine the pixel shift in the phase-encode direction. However, noise or artefacts in the ﬁeld map are highly problematic for pixel shift methods such as this and in our implementation (FUGUE FMRIB’s Utility for Geometrically Unwarping EPIs) a range of regularisation options are available. Initial tests have showed that simple Gaussian smoothing is usually adequate [20] but this is dependent on the ﬁeld map sequence and SNR. More recent research at FMRIB has been investigating applications of the ﬁeld map as a cost function weighting for registration. In addition, alternative approaches, which do not require a ﬁeld map, are being examined. We have been exploring a physical model-based method that calculates a ﬁeld map from a structural MR image using a perturbation solution of Maxwell’s equations [24]. This approach would allow studies where no ﬁeld maps are available to beneﬁt from the above distortion correction approaches, whilst still being derived
11

Figure 11: An example of ﬁeld-map-based distortion correction for EPI: structural image, ﬁeld map, original EPI, unwarped EPI
Figure 12: Example of simulated functional MR images showing modelled artefacts: within-scan motion, ghosting, B0inhomogeneities
from the individual subject’s own anatomy. Such constraints could also be beneﬁcial in other data-driven approaches to distortion correction within time-series, such as [1], and integration of these techniques is being explored.
5.2 MRI Simulation
There is a need for quantitative simulation of functional imaging experiments to: (1) validate existing analysis methods; (2) improve understanding of the interactions between acquisition and analysis; (3) provide forward models for artefact-reduction techniques. POSSUM (Physics-Oriented Simulated Scanner for Understanding MRI) is a simulation project designed to simulate the MR signal, starting from the fundamental physics. The inputs are in the form of general “pulse sequence” and “motion” ﬁles that specify gradients, RF pulses, sampling points and orientation as a function of time. Currently, the simulator uses the BrainWeb digital brain phantom [27] as the object model, but can use any sufﬁciently detailed voxel-based object model. Our main research interest in the POSSUM simulator is in modelling the interaction of motion and acquisition in order to further understand motion artefacts in FMRI and develop methods for removing these artefacts. To do this the simulator has been designed so that it incorporates bulk motion directly at the Bloch equation level, allowing within-scan motion, spin-history effects and B0-motion interaction to be accurately modelled. A consortium has recently been formed (with research groups at the Montreal Neurological Institute [27] and the University of Pittsburgh [36] who have complementary areas of expertise in instrumental and physiological aspects of FMRI modelling) to create a uniﬁed and comprehensive FMRI simulation environment named MIDAS (MR Imaging Data Acquisition Simulator: www.midas-online.org). Future work through this collaborative project will develop a simulator that incorporates the major sources of variation present in an FMRI acquisition: acquisition type (e.g., EPI, spiral-EPI, anatomical spin-echo), susceptibility artifacts, RF inhomogeneities, physiological noise, random noise, motion and activation. This simulator will be freely available to the FMRI community to aid researchers in validating their data processing streams and to provide insight into MRI physics.
6 FSL - FMRIB’s Software Library
Most of the research carried out by the FMRIB Analysis Group has been made available to the wider community as a single integrated software package, FSL (FMRIB’s Software Library). FSL is available as both source code and as self-contained binary distributions for Linux, MacOS X (Apple), Windows XP (under Cygwin), Solaris (Sun) and IRIX (Silicon Graphics). It is freely available for academic (non-commercial) use. Almost all tools can be run both from the command line and via GUI. The FSL binary distributions come with all necessary third-party software bundled, making installation and setup extremely easy. FSL is in active use in over 1000 laboratories worldwide. Most FSL tools come with web-based documentation, and the most complex tools (such as FEAT) include comprehensive “bubblepopup-help” in the GUI. Example data is supplied in a separate download named FEEDS (FSL Evaluation and Example Data Suite), which as well as providing example data for trying out the various FSL tools, includes a script which runs the core tools automatically and tests the results against supplied results, in order to check that FSL is running correctly. Further support on using FSL is offered
12

via the FSL email list, at www.jiscmail.ac.uk/lists/fsl.html .
As well as the research-derived tools described in this review paper, FSL also includes a series of command-line image utilities, including a program for extracting a range of image statistics from 3D/4D images, and a “calculator” utility with a wide range of mathematical operations for 3D/4D image manipulation. FSL also includes an intuitive yet powerful 3D/4D image display tool, FSLView, which allows multiple colour overlays, multiple orthogonal or lightbox views, time series display (graph-based and moviebased), image editing and histogram viewing.
7 Acknowledgements
We are grateful for ﬁnancial support from the UK Medical Research Council, the UK Engineering and Physical Sciences Research Council, The Wellcome Trust, GlaxoSmithKline and the Medical Images and Signals Inter-disciplinary Research Consortium (MIAS IRC). We also acknowledge vital collaborations with the many individuals listed at www.fmrib.ox.ac.uk/fsl/contributors.html
References
[1] J.L.R. Andersson, C Hutton, J Ashburner, R Turner, and K Friston. Modelling geometric distortions in EPI time series. NeuroImage, 13(5):903–919, 2001.
[2] P.R. Bannister, S.M. Smith, M. Brady, and M. Jenkinson. Spatio-temporal realignment of FMRI data. In Eighth Int. Conf. on Functional Mapping of the Human Brain, 2002.
[3] C.F. Beckmann, M. Jenkinson, and S.M. Smith. General multi-level linear modelling for group analysis in FMRI. NeuroImage, 20:1052–1063, 2003.
[4] C.F. Beckmann and S.M. Smith. Probabilistic Independent Component Analysis for Functional Magnetic Resonance Imaging. IEEE Trans. on Medical Imaging, 23(2):137–152, 2004.
[5] C.F. Beckmann and S.M. Smith. Tensorial extensions of independent component analysis for multisubject FMRI analysis. NeuroImage, 2005. in press.
[6] C.F. Beckmann, M.W. Woolrich, and S.M. Smith. Gaussian / Gamma mixture modelling of ICA/GLM spatial maps. In Ninth Int. Conf. on Functional Mapping of the Human Brain, 2003.
[7] T E J Behrens, M W Woolrich, M Jenkinson, H Johansen-Berg, R G Nunes, S Clare, P M Matthews, J M Brady, and S M Smith. Characterization and propagation of uncertainty in diffusion-weighted MR imaging. Magn Reson Med, 50(5):1077–1088, Nov 2003.
[8] T.E.J. Behrens, H. Johansen-Berg, M.W. Woolrich, S.M. Smith, C.A.M. Wheeler-Kingshott, P.A. Boulby, G.J. Barker, E.L. Sillery, K. Sheehan, O. Ciccarelli, A.J. Thompson, J.M. Brady, and P.M. Matthews. Non-invasive mapping of connections between human thalamus and cortex using diffusion imaging. Nature Neuroscience, 6(7):750–757, 2003.
[9] M. Bianciardi, A. Cerasa, and G. Hagberg. How experimental design and ﬁrst-level ﬁltering inﬂuence efﬁciency in second-level analysis of event-related fMRI data. In Ninth Int. Conf. on Functional Mapping of the Human Brain, 2003.
[10] B. Biswal, F.Z. Yetkin, Haughton V.M., and J.S. Hyde. Functional connectivity in the motor cortex of resting human brain using echo-planar MRI. Magnetic Resonance in Medicine, 34:537–541, 1995.
[11] R.B. Buxton, E.C. Wong, and L.R. Frank. Dynamics of blood ﬂow and oxygenation changes during brain activation: the balloon model. Magnetic Resonance in Medicine, 39:855–864, 1998.
[12] Basser P.J. Matiello J. Le Bihan D. Estimation of the effective self-diffusion tensor from the NMR spin echo. J. Magn. Reson. B, 103:247–254, 1994.
[13] M. De Luca, C. Beckmann, P.M. Matthews, N. De Stefano, and S.M. Smith. Spatial consistency of fMRI resting state networks across sessions and across subjects. In Proc. Int. Soc. of Magnetic Resonance in Medicine, 2004.
[14] M. De Luca, C.F. Beckmann, T. Behrens, S. Clare, P.M. Matthews, N. De Stefano, M. Woolrich, and S.M. Smith. Low frequency signals in FMRI - ”resting state networks” and the ”intensity normalisation problem”. In Proc. Int. Soc. of Magnetic Resonance in Medicine, 2002.
13

[15] N. De Stefano, M. Jenkinson, L. Guidi, M.L. Bartolozzi, A. Federico, and S.M. Smith. Voxel-level cross-subject statistical analysis of brain atrophy in early relapsing remitting MS patients. In Proc. Int. Soc. of Magnetic Resonance in Medicine, page 2625, 2003.
[16] B.S Everitt and E.T. Bullmore. Mixture model mapping of brain activation in functional magnetic resonance images. Human Brain Mapping, 7:1–14, 1999.
[17] K. J. Friston, W. Penny, C. Phillips, S. Kiebel, G. Hinton, and J. Ashburner. Classical and Bayesian inference in neuroimaging: Theory. NeuroImage, 16:465–483, 2002.
[18] K.J. Friston, O. Josephs, E. Zarahn, A.P. Holmes, S. Rouquette, and J-B. Poline. To smooth or not to smooth? NeuroImage, 12:196–208, 2000.
[19] A.P Holmes and K.J. Friston. Generalisability, random effects & population inference. In Fourth Int. Conf. on Functional Mapping of the Human Brain, NeuroImage, volume 7, page S754, 1998.
[20] M. Jenkinson. Improved unwarping of EPI volumes using regularised B0 maps. In Seventh Int. Conf. on Functional Mapping of the Human Brain, 2001.
[21] M. Jenkinson. A fast, automated, n-dimensional phase unwrapping algorithm. Magnetic Resonance in Medicine, 49(1):193– 197, 2003.
[22] M. Jenkinson, P.R. Bannister, J.M. Brady, and S.M. Smith. Improved optimisation for the robust and accurate linear registration and motion correction of brain images. NeuroImage, 17(2):825–841, 2002.
[23] M. Jenkinson and S.M. Smith. A global optimisation method for robust afﬁne registration of brain images. Medical Image Analysis, 5(2):143–156, June 2001.
[24] M. Jenkinson, J. Wilson, and P. Jezzard. Perturbation calculation of B0 ﬁeld for non-conducting materials. In Proc. Int. Soc. of Magnetic Resonance in Medicine, 2002.
[25] P. Jezzard and R.S. Balaban. Correction for geometric distortion in echo planar images from B0 ﬁeld variations. Magnetic Resonance in Medicine, 34:65–73, 1995.
[26] H. Johansen-Berg, T.E.J Behrens, E.L. Sillery, O. Ciccarelli, C.A.M. Wheeler-Kingshott, A.J. Thompson, S.M. Smith, and P.M. Matthews. Functional-anatomical validation and individual variation of diffusion tractography-based segmentation of the human thalamus. Cerebral Cortex, 15:31–39, January 2005.
[27] R.K.S. Kwan, A.C. Evans, and G.B. Pike. Mri simulation-based evaluation of image processing and classiﬁcation methods. IEEE Trans. on Medical Imaging, 18(11):1085–1097, November 1999.
[28] D.J. McGonigle, A.M. Howseman, B.S. Athwal, K.J. Friston, R.S.J. Frackowiak, and A.P. Holmes. Variability in fMRI: An examination of intersession differences. NeuroImage, 11:708–734, 2000.
[29] A. Roche, G. Malandain, X. Pennec, and N. Ayache. The correlation ratio as a new similarity measure for multimodal image registration. In Proc. of First Int. Conf. on Medical Image Computing and Computer-Assisted Intervention (MICCAI’98), volume 1496 of LNCS, pages 1115–1124, Cambridge, USA, October 1998. Springer Verlag.
[30] S.M. Smith. Fast robust automated brain extraction. Human Brain Mapping, 17(3):143–155, November 2002.
[31] S.M. Smith, C.F. Beckmann, N. Ramnani, M.W. Woolrich, P.R. Bannister, M. Jenkinson, P.M. Matthews, and D.J. McGonigle. Intersession variability in FMRI and the effect of different analysis methods. In Ninth Int. Conf. on Functional Mapping of the Human Brain, 2003.
[32] S.M. Smith and J.M. Brady. SUSAN - a new approach to low level image processing. International Journal of Computer Vision, 23(1):45–78, May 1997.
[33] S.M. Smith and N. De Stefano. Spatial statistical analysis of MTr images in different populations. In Proc. Int. Soc. of Magnetic Resonance in Medicine, 2002.
[34] S.M. Smith, N. De Stefano, M. Jenkinson, and P.M. Matthews. Normalised accurate measurement of longitudinal brain change. Journal of Computer Assisted Tomography, 25(3):466–475, May/June 2001.
[35] S.M. Smith, Y. Zhang, M. Jenkinson, J. Chen, P.M. Matthews, A. Federico, and N. De Stefano. Accurate, robust and automated longitudinal and cross-sectional brain change analysis. NeuroImage, 17(1):479–489, 2002.
[36] V. A. Stenger, H. Shi, D. Shroff, W. Eddy, and D. C. Noll. fmri acquisition informatics tool. In Human Brain Mapping, 2003. poster 951.
14

[37] Conturo T. Lori N. Cull T. Tracking neuronal ﬁber pathways in the living human brain. Proc Natl Acad Sci USA, 96:10422– 10427, 1999.
[38] P. Viola and W.M. Wells. Alignment by maximization of mutual information. International Journal of Computer Vision, 24(2):137–154, 1997.
[39] M.W. Woolrich, T.E.J. Behrens, C.F. Beckmann, M. Jenkinson, and S.M. Smith. Multi-level linear modelling for FMRI group analysis using Bayesian inference. NeuroImage, 21(4):1732–1747, 2004.
[40] M.W. Woolrich, T.E.J. Behrens, C.F. Beckmann, and S.M. Smith. Mixture models with adaptive spatial regularisation for segmentation with an application to FMRI data. IEEE Trans. on Medical Imaging, 24(1):1–11, 2005.
[41] M.W. Woolrich, T.E.J. Behrens, and S.M. Smith. Constrained linear basis sets for HRF modelling using Variational Bayes. NeuroImage, 21(4):1748–1761, 2004.
[42] M.W. Woolrich, M. Jenkinson, J.M. Brady, and S.M. Smith. Fully Bayesian spatio-temporal modelling of FMRI data. IEEE Trans. on Medical Imaging, 23(2):213–231, 2004.
[43] M.W. Woolrich, B.D. Ripley, J.M. Brady, and S.M. Smith. Temporal autocorrelation in univariate linear modelling of FMRI data. NeuroImage, 14(6):1370–1386, 2001.
[44] K.J. Worsley, A.C. Evans, S. Marrett, and P. Neelin. A three-dimensional statistical analysis for CBF activation studies in human brain. Journal of Cerebral Blood Flow and Metabolism, 12:900–918, 1992.
[45] Y. Zhang, M. Brady, and S. Smith. Segmentation of brain MR images through a hidden Markov random ﬁeld model and the expectation maximization algorithm. IEEE Trans. on Medical Imaging, 20(1):45–57, 2001.
15

